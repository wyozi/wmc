<!DOCTYPE html>
<html>
<head>
	<title>WMC: YouTube Player</title>
	<style type="text/css">
	html, body {
		height: 100%;
		margin: 0;
		padding: 0;
		margin-bottom: 0;

		overflow: hidden;
		background-color: black;
		height: calc(100% - 5px);
	}
	#playerdiv, embed {
		width: 100%;
		height: 100%;
	}
	</style>
</head>
<body>
	<div id="playerdiv"></div>
	<script type="text/javascript">

		// Detect flash (http://stackoverflow.com/a/9865667)
		var hasFlash = (function() {
			var a = !1,
				b = "";

			function c(d) {
				d = d.match(/[\d]+/g);
				d.length = 3;
				return d.join(".")
			}
			if (navigator.plugins && navigator.plugins.length) {
				var e = navigator.plugins["Shockwave Flash"];
				e && (a = !0, e.description && (b = c(e.description)));
				navigator.plugins["Shockwave Flash 2.0"] && (a = !0, b = "2.0.0.11")
			} else {
				if (navigator.mimeTypes && navigator.mimeTypes.length) {
					var f = navigator.mimeTypes["application/x-shockwave-flash"];
					(a = f && f.enabledPlugin) && (b = c(f.enabledPlugin.description))
				} else {
					try {
						var g = new ActiveXObject("ShockwaveFlash.ShockwaveFlash.7"),
							a = !0,
							b = c(g.GetVariable("$version"))
					} catch (h) {
						try {
							g = new ActiveXObject("ShockwaveFlash.ShockwaveFlash.6"), a = !0, b = "6.0.21"
						} catch (i) {
							try {
								g = new ActiveXObject("ShockwaveFlash.ShockwaveFlash"), a = !0, b = c(g.GetVariable("$version"))
							} catch (j) {}
						}
					}
				}
			}
			return a ? b : false;
		})();

		function getUrlParams() {
			var query = location.search.substr(1);
			var data = query.split("&");
			var result = {};
			for(var i=0; i<data.length; i++) {
				var item = data[i].split("=");
				result[item[0]] = item[1];
			}
			return result;
		}
		var params = getUrlParams();

		console.log("[WMC] Flash detected: " + hasFlash);

		if (params.forcehtml5) {
			hasFlash = false;
			console.log("[WMC] Forcing HTML5 player");
		}

		if (window.wmc) {
			wmc.SetFlashStatus(hasFlash == false ? false : true);
		}

		function playVideo(id, start) {
			if (hasFlash)
				document.getElementById("playerdiv").innerHTML = "<embed src=\"http://www.youtube.com/v/" + id + "?vq=hd720&version=3&enablejsapi=1&rel=0&fs=0&modestbranding=1&showinfo=0&autohide=1&autoplay=1&start=" + (start || 0) + "\"\
					type=\"application/x-shockwave-flash\"\
					id=\"player1\"\
					allowscriptaccess=\"always\"\
				/>";
			else
				document.getElementById("playerdiv").innerHTML = "<iframe src=\"http://www.youtube.com/embed/" + id + "?autoplay=1&start=" + (start || 0) + " \" width=\"100%\" height=\"100%\"></iframe>";
		}
		if (params.vid)
			playVideo(params.vid, params.start);
	</script>
</body>
</html>